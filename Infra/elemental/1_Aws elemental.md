# AWS Elemental 개념 정리


## AWS Elemental MediaConvert

AWS Elemental MediaConvert는 대용량 영상 파일을 자동으로 다양한 기기용 스트리밍 포맷으로 변환(인코딩)하는 관리형 서비스입니다.

비유하자면, 하나의 원본 영상을 스마트하게 여러 버전으로 “포장”해 주는 공장입니다. 웹, 모바일, TV 앱 등 각 기기가 요구하는 해상도·코덱·비트레이트와 자막·DRM까지 맞춰서 자동으로 만들어 줍니다. 서버를 직접 운영하거나 복잡한 인코더를 설치할 필요 없이, AWS에 작업을 “보내면” 결과물이 S3에 생성됩니다.

**핵심 개념 한 줄씩**

- **무엇을 하나요:** 업로드된 원본 영상(예: 4K ProRes, H.264)을 여러 출력 버전으로 변환합니다. 예: 모바일용 720p H.264, TV용 1080p H.265, 썸네일, 캡션 포함 등.
- **왜 필요한가요:** 시청자 기기·네트워크 환경이 제각각이라, 해상도/비트레이트별로 **적응형 스트리밍** 세트를 만들어야 합니다.
- **어떻게 쓰나요:** 작업(Job) 정의에 입력 S3 경로와 출력 설정(HLS/DASH, 비트레이트 Ladder, 오디오/자막)을 적고 제출하면, 백그라운드에서 변환이 진행됩니다.
- **관리 포인트:** 서버/코덱 설치, 스케일링, 큐 관리 없이 **완전관리형**으로 대량 처리와 QoS를 제공합니다.
- **결과물:** HLS(DRM 가능), DASH, MP4 등 표준 포맷의 세그먼트/마니페스트 파일을 S3에 생성합니다.

**주요 기능**

- **코덱/포맷 지원:** H.264/AVC, H.265/HEVC, AV1(지역/옵션에 따라), AAC, Dolby Audio, HLS/DASH/MP4.
- 비트레이트 Ladder 자동/커스텀, 키프레임·프레임레이트·해상도 제어, **자막/캡션** 번들, 썸네일/스프라이트.
- **DRM 연동:** FairPlay/Widevine/PlayReady는 MediaPackage/License 서버와 조합해 적용.
- **QoS/모니터링:** CloudWatch로 작업 상태·에러·성능 메트릭 확인, 실패 시 재시도 정책.
- **대량 처리:** 큐(Priority/On-Demand/Reserved)로 동시 작업 관리, 예약 인스턴스 구매로 비용 최적화.

**MediaConvert vs. MediaLive vs. MediaConnect**

- **MediaConvert:** 파일 기반(온디맨드 VOD) 인코딩. 업로드된 녹화물·영화·클립을 여러 출력으로 변환.
- **MediaLive:** 라이브 이벤트 실시간 인코딩. 입력 RTP/Zixi 등을 받아 실시간 HLS/DASH로 송출.
- **MediaConnect:** 라이브 **전송 파이프라인**. 스튜디오/경기장→클라우드 간 신뢰성 높은 전송과 복제.

**전형적 아키텍처 흐름**

1. 원본 VOD를 S3에 업로드.
2. S3 이벤트 또는 Lambda로 MediaConvert Job 생성.
3. 출력(HLS/DASH/MP4)을 S3에 저장.
4. CDN인 **Amazon CloudFront**로 배포, 플레이어는 마니페스트(HLS/DASH) 재생.

**비용과 운영**

- 과금은 주로 **분 단위 인코딩 처리량**과 출력 설정(코덱/해상도/프로필)에 따라 달라집니다.
- 대량·반복 워크로드는 **Reserved Transcoding Slots**로 할인 가능.
- 저장/전송 비용(S3, CloudFront)도 함께 고려해야 합니다.

**언제 선택하면 좋은가**

- 다양한 기기/네트워크에 맞춘 VOD 스트리밍을 안정적으로 제공해야 할 때.
- 인하우스 인코딩 파이프라인 운영 부담(서버/업데이트/확장)을 줄이고 싶을 때.
- 표준 포맷과 DRM, 캡션, 썸네일 등 방송급 요건을 손쉽게 맞추고 싶을 때.

## AWS MediaConvert 입력, 출력 스트리밍 형식

**HLS**

- MediaConvert가 지원하는 입력 프로토콜
- HLS(HTTP Live Streaming) 이란

  • **Apple**이 만든, 표준화되어 널리 쓰이는 적응형 스트리밍 프로토콜입니다.

  • 핵심 아이디어는 긴 동영상을 작은 조각(세그먼트)으로 나눠 일반 HTTP 서버를 통해 전송하고, 플레이어가 네트워크 상태에 맞춰 화질(비트레이트)을 자동으로 바꿔 재생한다는 점입니다.

  • CDN과 캐시 친화적이고, 방화벽을 잘 통과하며, 모바일·웹·TV 대부분에서 지원됩니다.

- **어떻게 동작하나요?** 
• 재생은 하나의 텍스트 파일인 매니페스트(playlist, 보통 .m3u8)로 시작합니다. 매니페스트에는 세그먼트 파일 목록과 각 조각의 길이, 코덱, 해상도 같은 메타데이터가 담깁니다. 플레이어는 이 목록을 따라 조각들을 순서대로 내려받아 재생합니다.
  • 적응형(ABR) 구조에서는 상위 매니페스트가 여러 **변형(variant)** 스트림을 나열합니다. 예를 들어 1080p 6Mbps, 720p 3Mbps, 480p 1.5Mbps 같은 여러 품질이 있고, 플레이어는 네트워크/CPU 상황을 보고 적절한 변형으로 전환합니다.
  • 세그먼트 컨테이너는 전통적으로 **MPEG-TS**(전송 스트림) 파일을 씁니다. 최근에는 **fMP4/CMAF**도 많이 쓰지만, 도구나 규격에 따라 요구사항이 달라집니다. 이 페이지 맥락에서는 입력으로 TS가 명시되어 있습니다.
  • 라이브와 VOD 모두 지원합니다. 라이브는 매니페스트가 계속 갱신되며 최신 세그먼트를 추가합니다. VOD는 끝을 표시하는 태그로 재생 완료 지점을 알려줍니다.
- https://docs.aws.amazon.com/ko_kr/mediaconvert/latest/ug/using-hls-inputs.html

**CMAF**

- MediaConvert에서 스트리밍 출력 포맷으로 지원
- 영상 스트리밍을 기기마다 다르게 나누지 않고 하나로 통일해 보내는 표준 포맷

  • 예전엔 iPhone(HLS)과 안드로이드/브라우저(DASH)용 파일을 따로 만들어야 했지만, CMAF로는 하나의 조각 묶음으로 두 방식(HLS/DASH)을 모두 지원

- 왜 중요한가 
• 제작 단순화: 한 번 인코딩해 여러 플랫폼에 공통으로 사용.
  • 지연 시간 감소: 작은 조각을 빠르게 보내 저지연 라이브에 유리.
  • 비용 절감: 중복 저장·전송이 줄어 스토리지와 CDN 비용 절약.
  • 광고/개인화 호환: 콘텐츠와 동일한 포맷으로 광고 세그먼트도 쉽게 끼워 넣기.
- https://docs.aws.amazon.com/ko_kr/mediaconvert/latest/ug/choosing-your-streaming-output-groups.html

## AWS Elemental Live

AWS Elemental MediaLive는 실시간 동영상(라이브 스트리밍)을 안정적으로 송출하도록 해주는 AWS의 관리형 인코딩 서비스입니다.

**무엇을 하는 서비스인가**

MediaLive는 카메라/중계 장비에서 들어온 **라이브 비디오 입력**을 받아, 시청자에게 적합한 여러 해상도와 비트레이트로 **실시간 인코딩(트랜스코딩)**하고, 스트리밍에 맞는 **출력 포맷(HLS/DASH 등)**으로 만들어 내보냅니다. 쉽게 말해 “원본 생방송 영상을 인터넷 시청에 맞게 즉시 가공해 주는 공장”입니다.

**왜 필요한가**

- **적응형 스트리밍**: 네트워크 상태가 다양한 시청자에게 자동으로 알맞은 화질/비트레이트를 제공하려면 다중 프로필(ABR) 인코딩이 필요합니다. MediaLive가 이를 실시간으로 만들어 줍니다.
- **안정성/가용성**: 라이브는 끊김이 치명적입니다. MediaLive는 채널 이중화, 입력 장애 시 자동 페일오버 등으로 방송을 **탄탄하게 유지**합니다.
- **운영 편의**: 서버를 직접 구축·운영하지 않아도 되고, 콘솔/API로 채널을 생성·시작·중지하며 **완전 관리형**으로 운용합니다.

**기본 구성 흐름**

1. **입력**: RTMP, HLS, SRT 등으로 카메라/엔코더에서 MediaLive에 영상을 보냅니다.
2. **채널**: 인코딩 파이프라인의 본체입니다. 해상도(1080p/720p/480p…), 비트레이트, 코덱(**H.264/H.265**) 등 **출력 그룹**을 설계합니다.
3. **출력**: 보통 **HLS**로 내보내며, **AWS MediaPackage**에 연결해 스케일/DRM/타임시프트를 더하고, 최종적으로 **CloudFront** CDN을 통해 전 세계 시청자에게 배포합니다.

**핵심 개념만 쏙쏙**

- **채널(Channel)**: 라이브 인코딩 작업 단위. 시작/중지 가능.
- **입력(Input)**: 영상이 들어오는 방식과 소스. 백업 입력을 함께 두어 장애에 대비.
- **출력 그룹(Output Group)**: HLS/DASH/Archive 등 목적지 묶음. 한 채널에서 여러 그룹 병행 가능.
- **ABR 레더(프로필)**: 서로 다른 해상도·비트레이트 세트. 플레이어가 상황에 맞춰 전환.
- **디인터레이스/필터**: 방송 소스 품질 보정.
- **예약/스케줄링**: 특정 시간에 소스 컷 전환, 슬레이트(대기 화면) 삽입 등 자동화.

**비용과 성능 감**

- **사용량 기반 과금**: 채널이 **실행 중일 때만** 인코딩 비용이 발생하며, 프로필 수·해상도·코덱(H.265가 보통 더 비쌈)·이중화 여부에 따라 달라집니다.
- **지연 시간**: 일반 HLS는 수초 단위 지연, **Low-Latency HLS**/MediaPackage 조합으로 더 낮출 수 있습니다. 초저지연 대화형 용도면 WebRTC 계열이 맞을 수 있습니다.

**언제 MediaLive가 적합한가**

- 스포츠/콘서트/행사 같은 **대규모 라이브 방송**
- **복수 해상도**와 방송 품질이 필요한 프로 제작 환경
- 장애 대비, 다채널 운영, 규정 준수(녹화/로깅) 등이 중요한 경우

**빠른 시작 가이드**

- **입력 준비**: 현장 인코더에서 RTMP(S)/SRT로 송출. 백업 입력도 설정.
- **채널 생성**: ABR 레더를 1080p/720p/480p 정도로 설계하고 코덱을 정합니다.
- **출력 연결**: HLS 출력 → **MediaPackage** → **CloudFront**로 배포 파이프라인 구성.
- **운영**: 채널 시작 후 헬스 메트릭을 모니터링하고, 장애 시 자동 페일오버를 확인합니다.

요약하면, MediaLive는 실시간 영상을 시청자 친화적으로 변환·안정적으로 내보내는 **프로급 인코딩 엔진**을 AWS가 관리형으로 제공하는 서비스입니다.

**참고 글**

- [**[How To] AWS Media Service를 이용한 실시간 스트리밍 서비스 만들기**](https://www.bespinglobal.com/download/cloud-insight/HowTo_LiveStreamingService.pdf)

## AWS Elemental Live 에서 **HEVC 지원**

- HEVC는 같은 화질을 더 작은 파일 크기로 만드는 최신 영상 압축 기술
- HEVC는 High Efficiency Video Coding의 줄임말로, 영상의 불필요한 정보를 더 똑똑하게 줄여 보내고 저장하게 해주는 코덱입니다. 예전의 **H.264**와 비교하면 보통 같은 화질을 약 **30~50%** 더 적은 용량과 대역폭으로 제공합니다. 그래서 4K/UHD, HDR, 고프레임률 같은 고화질 라이브 스트림에 특히 잘 맞습니다.
- 쉽게 비유하면, 같은 내용을 더 효율적으로 접어서 보내는 “정리의 기술”입니다. 덕분에
    - 스트리밍이 덜 끊기고, 네트워크 비용이 줄고,
    - 저장 공간을 덜 쓰면서,
    - 고화질을 유지하거나 더 올리기 쉬워집니다.
- 다만, 재생 기기와 브라우저가 HEVC를 지원해야 하고, 인코딩은 H.264보다 계산량이 많아 송출 측 리소스가 더 필요할 수 있습니다.
- **AWS Elemental MediaLive**는 HEVC로 SD/HD/UHD와 **HDR**까지 라이브 출력할 수 있게 해 고품질 방송에 유리합니다.

## AWS Elemental MediaConnect

AWS Elemental MediaConnect는 라이브 영상 신호를 클라우드로 안전하게 받아 여러 목적지로 신뢰성 있게 전달하는 관리형 전송 서비스입니다.

**무엇을 하는 서비스인가**

MediaConnect는 경기장·스튜디오 같은 외부 현장에서 나오는 **라이브 비디오**를 클라우드로 **인입(ingest)** 하고, 그 신호를 **복제·분배(distribute)** 해서 여러 리전, 여러 시스템(예: 인코더, 녹화, 패키징)으로 보내줍니다. 목표는 방송급 품질로 끊김 없이 전달하는 것입니다.

**왜 필요할까**

라이브는 파일 인코딩과 달리 “지금 이 순간”이 전부라서 패킷 손실·지터가 치명적입니다. 기존엔 **위성/전용 회선**으로 비쌌고 유연성이 낮았죠. MediaConnect는 **AWS 글로벌 네트워크** 위에서 표준 프로토콜과 오류 보정으로 품질을 확보하면서, 리전 간 복제와 계정 간 공유를 손쉽게 제공합니다.

**핵심 기능 한눈에**

- **전송 프로토콜:** RTP, **RTP-FEC**(Forward Error Correction), **Zixi** 등 방송 현장에서 쓰는 신뢰성 높은 프로토콜을 지원.
- **보안:** 스트림을 **AES-256**으로 암호화하고 키를 **AWS Secrets Manager**에 안전 보관.
- **복제/분배:** 하나의 인입 스트림을 여러 **출력(Flow Outputs)** 으로 자동 복제해 리전·계정·온프렘으로 동시 전달.
- **가시성:** **CloudWatch** 연동으로 QoS 알람, 실시간 텔레메트리로 상태 확인 및 운용.
- **권한 공유:** **Entitlement(ARN)** 로 다른 AWS 계정에 스트림 접근 권한을 부여.

**어디에 쓰나**

- 라이브 이벤트 신호를 받아 **MediaLive**로 넘겨 실시간 **인코딩(HLS/DASH)** 하고, 동시에 제작/모니터링/백업으로 분기.
- 유럽에서 들어온 신호를 미국·아시아 리전으로 **동시 중계**.
- 외부 파트너(다른 AWS 계정)와 **보안 있게 신호 공유**.

**간단한 흐름 예시**

1. 경기장 인코더가 **Zixi/RTP-FEC** 로 클라우드에 송출.
2. MediaConnect가 신호를 **수신·복제**.
3. 한 출력은 **MediaLive**로 연결해 방송용 HLS 생성, 다른 출력은 **미국 리전**으로 재전송, 또 다른 출력은 **제작사 계정**으로 공유.
4. 상태는 **CloudWatch**에서 모니터링, 장애 시 출력 경로를 **콘솔/API** 로 재라우팅.

**가격과 리전**

- **과금:** 흐름(Flow) **시간당 비용** + **전송 데이터량**. 선결제 없이 사용량 기반.
- **리전:** 글 기준 **8개 리전**에서 시작해 제공. 실제 사용 전 최신 리전 목록을 확인하세요.

요약하면, MediaConnect는 라이브 비디오를 “방송급 품질로, 인터넷 경제성으로” 클라우드에서 이동시키는 **신뢰성 높은 분배 허브**입니다.

## AWS Elemental MediaTailor

MediaTailor는 동영상에 서버에서 광고를 깔끔히 삽입해 주는 AWS 서비스입니다.

**핵심 개념 한 줄씩**

- **무엇을 하나요:** 라이브 스트림과 VoD에 광고를 서버 사이드로 삽입해, 시청자는 끊김 없이 재생하고 광고는 개인화됩니다.
- **왜 서버 사이드인가:** 플레이어마다 다르게 동작하는 클라이언트 SDK 대신, 서버가 매니페스트를 만들어 광고를 섞어 주니 호환성과 안정성이 좋아집니다.
- **어떻게 개인화되나:** 시청자 정보로 광고 서버(ADS)에 요청해 VAST 응답을 받고, 그 광고를 트랜스코딩해 재생 목록에 포함합니다.
- **어디에 쓰나:** FAST 채널 구성(VoD를 TV처럼 편성)과 라이브 방송 중 광고 큐(SCTE‑35)로 지정된 구간에 동적 광고 삽입.

**작동 흐름을 그림 없이 말로**

- 시청자가 먼저 **매니페스트(HLS/DASH)**를 요청합니다. 기본 매니페스트는 MediaPackage에서 나옵니다.
- MediaTailor가 사용자별 광고를 포함한 **새 매니페스트**를 생성해 전달합니다. 여기엔 본영상 조각과 광고 조각의 경로가 섞여 있습니다.
- 콘텐츠 조각은 원래 오리진/CloudFront에서, 광고 조각은 MediaTailor가 관리하는 경로(S3+내부 CF)에서 내려갑니다.
- MediaTailor는 광고 조각 전송을 **서버 측 리포팅**으로 추적해 “얼마나 봤는지”를 광고 서버에 보고합니다.
- 라이브의 경우 MediaLive에서 **SCTE‑35** 큐톤(CUE‑OUT/IN)을 일정(Schedule)로 넣으면, 그 구간에 개인화 광고가 삽입됩니다.

**FAST 채널과 편성**

- VoD를 **채널**로 묶고, **프로그램** 단위로 본영상과 **광고 슬롯**을 배치합니다.
- 소스는 S3 같은 저장소의 **소스 위치(prefix)**로 관리하고, 본영상과 광고를 분리해 둡니다.
- 매니페스트와 세그먼트 길이를 맞춰야 매끄럽게 섞입니다(예시: 모두 **6초 세그먼트**).

**개발자가 알면 좋은 포인트**

- **플레이어 호환성:** 서버사이드 삽입이라 모바일/TV/웹 플레이어별 SDK 부담이 줄어듭니다.
- **캐싱 전략:** 개인화 매니페스트는 사용자별로 달라 **CDN 캐싱을 신중히** 설정해야 합니다. 반면 콘텐츠/광고 조각 파일은 캐싱 이점이 큽니다.
- **광고 품질 맞춤:** 광고도 본 스트림과 **코덱/세그먼트 길이**를 맞춰야 스위치 시 버퍼링이 줄어듭니다.
- **측정/리포팅:** 서버가 조각 전송을 기준으로 **시청 완료/중간 이탈**을 추적하니, 클라이언트 이벤트 누락에 강합니다.
- **연동 지점:** ADS(VAST XML), SCTE‑35 신호, CloudFront 캐시 정책, MediaPackage 오리진 설정이 실무 핵심입니다.

**한 문장 요약**

개발 관점에서 MediaTailor는 “매니페스트를 사용자별로 재작성해 본영상과 광고를 자연스럽게 혼합하고, 전달/측정을 서버에서 책임지는” 광고 삽입 오케스트레이터입니다.
